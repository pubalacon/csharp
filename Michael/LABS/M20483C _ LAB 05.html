<!DOCTYPE html>
<!-- saved from url=(0077)https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M20483C | All Modules - Programming in C# - go  deploy</title>

        <link rel="stylesheet" href="./M20483C _ LAB 05_files/godeployMain.min.css">
    <link rel="stylesheet" href="./M20483C _ LAB 05_files/all.css" integrity="sha384-6jHF7Z3XI3fF4XZixAuSu0gGKrXwoX/w3uFPxC56OtjChio7wtTGJWRW53Nhx6Ev" crossorigin="anonymous">

    
    <link rel="stylesheet" type="text/css" href="./M20483C _ LAB 05_files/labs.min.css">

</head>
<body class="" style="background-color: rgb(255, 255, 255);">
    <nav class="navbar navbar-expand-md navbar-dark fixed-top py-0 bg-brand" id="main-navbar">
        <span class="h1 navbar-brand brandname my-1 ">go  deploy</span>
            <div class="navbar-text h5 font-weight-normal my-1 ml-1 mr-auto collapse navbar-collapse" id="navbar-title">M20483C | All Modules - Programming in C#</div>
        <div class="collapse navbar-collapse header-nav" id="header-nav-menu">
<form action="https://lms.godeploy.it/Account/LogOff?Length=6" class="navbar-right" id="logoutForm" method="post"><input name="__RequestVerificationToken" type="hidden" value="RzxbEh_C_O1u5siOYspFt00Ol_pPjLWXqtcnvwlY-dJm6E7EbwmIrsKZCvKJfCvOh6f4vZroMcEYhsZAIZRplrPKUtyTs0-x5ENFzroXHbqwX7SBnmXvi2sCbI-RqxCbQVMqLMB8kVrSYGC2VA9k8A2"></form>        <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" style="font-size: 1.4em;" href="https://lms.godeploy.it/RedirectToHome" title="Home">
                    <i class="far fa-home" title="Home"></i>
                </a>
            </li>
                                    
            <li class="nav-item dropdown">
                <a class="nav-link" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="font-size: 1.4em;" aria-label="Account profile icon that opens a list of account options">
                    <i class="far fa-user-circle"></i>
                </a>
                <div class="dropdown-menu dropdown-menu-right shadow" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="https://lms.godeploy.it/Manage">oheinrich@orange.fr</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="javascript:document.getElementById(&#39;logoutForm&#39;).submit()">Log off</a>
                </div>
            </li>

            <li class="nav-item">
                <a href="https://godeploy.zendesk.com/hc/en-us" target="_blank" class="nav-link" style="font-size: 1.4em;"><span class="sr-only">Help icon that links to the help articles and allows you to create support requests</span><i class="far fa-question-circle" title="Help"></i></a>
            </li>
        </ul>
</div>


    </nav>

    

<main id="lab-container" class="h-100" data-mei-id="f2def404-29f7-e911-abe3-00155de2c913">
    <h1 class="sr-only">M20483C | All Modules - Programming in C#</h1>
    <div class="row h-100 no-gutters">
        <div class="col bg-light h-100 position-relative" style="overflow-y: auto; flex-basis: calc(67.9696% - 3px);" id="lab-content-container">

            <nav class="navbar navbar-expand navbar-light bg-gray-400" id="lab-navbar">
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link tab-link" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#" id="tab-home-link" data-target="tab-home" data-link-text="Home" data-scroll-top="0">Home</a>
        </li>
            <li class="nav-item active bg-light">
                <a class="nav-link tab-link" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#" id="tab-lab-guide-link" data-target="tab-lab-guide" aria-valuetext="Lab Guide">Lab Guide</a>
            </li>
            </ul>
</nav>


            <div class="container position-relative pt-2 lab-tab" id="tab-home" style="display: none;">
                    <div class="mb-4">
        <h6 class="mt-0"><i class="fa fa-server"></i> Virtual Machines</h6>

        <div class="popover-help mb-2" data-toggle="popover" data-content="Select Virtual Machine" data-original-title="" title="">
            <div class="dropdown" id="vm-dropdown">
                <button class="btn btn-sm btn-outline-secondary dropdown-toggle btn-block text-left" type="button" id="vm-dropdown-btn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">20483C-SEA-DEV1</button>
                <div class="dropdown-menu" aria-labelledby="vm-dropdown-btn" id="vm-dropdown-menu">
                        <a class="dropdown-item active" data-vm-id="f7def404-29f7-e911-abe3-00155de2c913" data-vm-credentials="[{&quot;Username&quot;:&quot;Admin&quot;,&quot;Password&quot;:&quot;Pa55w.rd&quot;}]" data-has-optical-drive="false" data-has-floppy-drive="true)" data-vm-name="20483C-SEA-DEV1" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#">20483C-SEA-DEV1</a>
                </div>
            </div>
        </div>

        <button type="button" id="cad-btn" class="btn btn-sm btn-outline-secondary mb-1">Ctrl+Alt+Del</button>

        <button class="btn btn-sm btn-outline-secondary reconnect-display-btn popover-help mb-1" data-toggle="popover" data-content="Reconnect selected VM Display" data-original-title="" title="">
            <i class="fas fa-sync"></i>
        </button>

        <div class="btn-group popover-help mb-1" data-toggle="popover" data-content="Selected VM Power Operations" data-original-title="" title="">
            <div class="dropdown">
                <button class="btn btn-sm btn-outline-secondary" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="far fa-bolt"></i>
                </button>
                <div class="dropdown-menu" aria-labelledby="pwr-dropdown-btn" id="pwr-dropdown-menu">
                    <a class="dropdown-item text-danger power-op" data-op="stop" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#">Power Off</a>
                    <a class="dropdown-item text-danger power-op" data-op="start" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#">Power On</a>
                    <a class="dropdown-item text-danger power-op" data-op="restart" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#">Restart</a>
                        <a class="dropdown-item text-danger power-op" data-op="reset-gateway" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#">Reset Gateway</a>
                </div>
            </div>
        </div>




        <div id="vm-credentials-target" style="font-size: 80%" class="mt-3">
            <table>
                <tbody><tr>
                    <th class="pr-2">Username</th>
                    <td>Admin</td>
                    <td class="pl-2"><i class="fas fa-paste paste-credential paste-tab" data-text="Admin"></i></td>
                </tr>
                <tr>
                    <th class="pr-2">Password</th>
                    <td>Pa55w.rd</td>
                    <td class="pl-2"><i class="fas fa-paste paste-credential paste-enter" data-text="Pa55w.rd"></i></td>
                </tr>
            </tbody></table>
    </div>
    </div>
    <hr>



<div class="mb-4 position-relative" aria-label="VM Tools">
    <h6><i class="fa fa-wrench"></i> Tools</h6>
        <button id="fullscreen-btn" type="button" class="btn btn-sm btn-outline-secondary popover-help mb-1" data-toggle="popover" data-content="Fullscreen mode" data-original-title="" title="">
            <i class="far fa-expand-alt"></i>
        </button>
        <button id="exit-fullscreen-btn" type="button" class="btn btn-sm btn-outline-secondary popover-help mb-1" style="display: none;" data-toggle="popover" data-content="Exit fullscreen mode" data-original-title="" title="">
            <i class="far fa-compress-alt"></i>
        </button>
        <a id="screenshotBtn" class="btn btn-sm btn-outline-secondary popover-help mb-1" data-toggle="popover" data-content="Take a screenshot" data-original-title="" title="">
            <i class="far fa-file-image"></i>
        </a>
        <div class="btn-group mb-1 popover-help" data-toggle="popover" data-content="Paste into the VM" data-original-title="" title="">
            <div class="dropdown" id="paste-box-dropdown">
                <button class="btn btn-sm btn-outline-secondary" type="button" id="paste-box-dropdown-btn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="far fa-paste"></i>
                </button>
                <div class="dropdown-menu bg-success text-white" aria-labelledby="paste-box-dropdown-btn">
                    <div class="px-3 py-2 position-relative">
                        <p class="text-center mt-0"><strong>Paste Activated</strong></p>
                        <p class="text-justify mb-0">You may paste using Ctrl + V or right click here and click 'Paste'</p>
                        <textarea id="paste-box" class="position-absolute h-100 w-100" style="opacity: 0; top: 0; left: 0" disabled=""></textarea>
                    </div>
                </div>
            </div>
        </div>
    <div class="btn-group mb-1 popover-help" data-toggle="popover" data-content="Exit Lab Options" data-original-title="" title="">
        <div class="dropdown">
            <button class="btn btn-sm btn-outline-secondary" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Exit Lab
            </button>
            <div class="dropdown-menu" aria-labelledby="end-dropdown-btn" id="end-dropdown-menu">
                    <a class="dropdown-item text-success" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#" data-toggle="modal" data-target="#save-lab-modal">Exit and Save Lab</a>
                <a class="dropdown-item text-danger" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#" data-toggle="modal" data-target="#end-lab-modal">Exit and End Lab</a>
            </div>
        </div>
    </div>
        <div class="custom-control custom-checkbox mt-2 popover-help" data-toggle="popover" data-content="Switching Enhanced Mode on enables audio and improved display resolution features" data-original-title="" title="">
            <input type="checkbox" class="custom-control-input" id="enhanced-mode-switch">
            <label class="custom-control-label" for="enhanced-mode-switch">Enhanced Mode</label>
        </div>
</div>

<div class="mb-4">
    <h6><i class="fas fa-info-circle"></i> Lab Information</h6>
    <p>
            <a data-toggle="modal" data-target="#launch-info-modal" aria-haspopup="true" aria-expanded="false" href="https://lms.godeploy.it/Labs/DelegateLab/f2def404-29f7-e911-abe3-00155de2c913#">Show Lab Information</a>
            <br>
        <a href="https://godeploy.zendesk.com/hc/en-us/requests/new" target="_blank">Submit a Support Request</a>
    </p>
</div>

            </div>

<div id="tab-lab-guide" class="lab-tab container position-relative pt-4" style="">
    <div id="labGuideContainer">
        <h6><i class="fas fa-book"></i> Lab Guide</h6>
        <div class="py-2">
            <button class="btn btn-sm btn-brand popout-btn d-block w-100" data-link="/Labs/LabGuide/f2def404-29f7-e911-abe3-00155de2c913">
                View in Another Window
            </button>
        </div>
        <div class="form-inline">
<div class="btn-group btn-group-sm mr-2" id="labGuidePageSelector" style="">
    <button type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Lab 5</button>
    <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; transform: translate3d(0px, 26px, 0px); top: 0px; left: 0px; will-change: transform;">
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=87a301e4-e6ac-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="87a301e4-e6ac-e811-8373-00155d026631">Lab 1</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=1c980c6c-43fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="1c980c6c-43fd-e811-8373-00155d026631">Lab 2</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=5d3d54a8-43fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="5d3d54a8-43fd-e811-8373-00155d026631">Lab 3</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=e61a2fd7-43fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="e61a2fd7-43fd-e811-8373-00155d026631">Lab 4</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=8bf74af0-43fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link active" data-page-id="8bf74af0-43fd-e811-8373-00155d026631">Lab 5</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=f90df406-44fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="f90df406-44fd-e811-8373-00155d026631">Lab 6</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=780fb7b3-44fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="780fb7b3-44fd-e811-8373-00155d026631">Lab 7</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=3a876de6-44fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="3a876de6-44fd-e811-8373-00155d026631">Lab 8</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=88a3d872-45fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="88a3d872-45fd-e811-8373-00155d026631">Lab 9</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=ca0447b3-45fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="ca0447b3-45fd-e811-8373-00155d026631">Lab 10</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=7db412da-45fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="7db412da-45fd-e811-8373-00155d026631">Lab 11</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=5a3fb3fa-45fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="5a3fb3fa-45fd-e811-8373-00155d026631">Lab 12</a>
            <a href="https://lms.godeploy.it/Labs/LabGuidePageMarkup/f2def404-29f7-e911-abe3-00155de2c913?pageId=87bd782a-46fd-e811-8373-00155d026631" class="dropdown-item lab-guide-page-link" data-page-id="87bd782a-46fd-e811-8373-00155d026631">Lab 13</a>
    </div>
</div>

            <div class="custom-control custom-checkbox ml-2">
                <input type="checkbox" class="custom-control-input" id="show-screenshots-checkbox">
                <label class="custom-control-label" for="show-screenshots-checkbox">Show Screenshots</label>
            </div>
        </div>
        <div class="lab-markdown reduced-headers pt-2" id="lab-guide-area"><h3 id="module-5-creating-a-class-hierarchy-by-using-inheritance">Module 5: Creating a Class Hierarchy by Using Inheritance</h3>
<div class=" alert alert-danger"><p>Important Information about running this class.</p>
<p>YOU MUST SAVE THE LABS EVERY DAY.  YOU SHOULD ALSO CHECK THE LABS ARE SAVED BY LOGGING BACK INTO THE LMS.</p>
<p>FAILING TO DO SO WILL RESULT IN LOSS OF WORK WHICH IS UNRECOVERABLE.  GO DEPLOY WILL BE UNABLE TO RECOVER LABS WHICH HAVE NOT BEEN SAVED!</p></div>
<h4 id="lab-refactoring-common-functionality-into-the-user-class">Lab: Refactoring Common Functionality into the User Class</h4>
<div class=" alert alert-secondary"><p><strong>Scenario</strong></p>
<p>You have noticed that the Student and Teacher classes in the Grades application contain some duplicated functionality. To make the application more maintainable, you decide to refactor this common functionality to remove the duplication. You are also concerned about security. All teachers and students require a password, but it is important to maintain confidentiality and at the same time ensure that students (who are children) do not have to remember long and complex passwords. You decide to implement different password policies for teachers and students; teachers' passwords must be stronger and more difficult to guess than student passwords. Also, you have been asked to update the application to limit the number of students that can be added to a class. You decide to add code that throws a custom exception if a user tries to enroll a student in a class that is already at capacity.</p>
<p><strong>Objectives</strong></p>
<p>After completing this lab, you will be able to:</p>
<ul>
<li>Use inheritance to factor common functionality into a base class.</li>
<li>Implement polymorphism by using an abstract method.</li>
<li>Create a custom exception class.</li>
</ul>
<p><strong>Lab Setup</strong></p>
<p>Estimated Time: <strong>60 minutes</strong></p></div>
<h4 id="exercise-1-creating-and-inheriting-from-the-user-base-class">Exercise 1: Creating and Inheriting from the User Base Class</h4>
<div class=" alert alert-secondary"><p><strong>Scenario</strong></p>
<p>In this exercise, you will create an abstract base class called User that contains the UserName and Password properties and the VerifyPassword method that is common to the Student and Teacher classes.</p>
<ul>
<li>You will modify the definitions of the Student and Teacher classes to inherit from the User class and remove the UserName and Password properties and the VerifyPassword method from these classes.</li>
<li>Finally, you will build and run the application without making any other changes to the application, and then verify that it still works correctly.</li>
</ul></div>
<h5 id="task-1-create-the-user-abstract-base-class">Task 1: Create the User abstract base class</h5>
<ol>
<li><p>Click <strong>Visual Studio 2017</strong>.</p></li>
<li><p>In <strong>Visual Studio</strong>, on the <strong>File</strong> menu, point to <strong>Open</strong>, and then click <strong>Project/Solution</strong>.</p></li>
<li><p>In the <strong>Open Project</strong> dialog box, browse to <strong>[Repository Root]\allfiles\Mod05\Labfiles\Starter\Exercise 1</strong>, click <strong>GradesPrototype.sln</strong>, and then click <strong>Open</strong>.</p><div class=" alert alert-warning"><p><strong>Note :</strong> If any Security warning dialog box appears, clear <strong>Ask me for every project in this solution</strong> check box and then click <strong>OK</strong>.</p></div><p></p></li>
<li><p>In <strong>Visual Studio</strong>, on the <strong>View</strong> menu, click <strong>Task List</strong>.</p></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 1a: Create the User abstract class with the common functionality for Teachers and Students</strong> task.</p></li>
<li><p>In the code editor, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">User</span>
<span class="token punctuation">{</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public abstract class User
{" class="paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>Click at the end of the last comment in the block (before the <strong>Grade</strong> class declaration), press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="}" class="paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 1b: Add the UserName property to the User class</strong> task. </p></li>
<li><p>In the code editor, click at the end of the comment, press Enter, and then type the following code: </p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">string</span> UserName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public string UserName { get; set; }" class="paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double click the <strong>TODO: Exercise 1: Task 1c: Add the Password property to the User class</strong> task. </p></li>
<li><p>In the code editor, click at the end of the comment, press Enter, and then type the following code: </p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">private</span> <span class="token keyword">string</span> _password <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Generate a random password by default</span>

<span class="token keyword">public</span> <span class="token keyword">string</span> Password
<span class="token punctuation">{</span>
   <span class="token keyword">set</span>
   <span class="token punctuation">{</span>
      _password <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="private string _password = Guid.NewGuid().ToString(); // Generate a random password by default

public string Password
{
   set
   {
      _password = value;
   }
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double click the <strong>TODO: Exercise 1: Task 1d: Add the VerifyPassword method to the User class</strong> task. </p></li>
<li><p>In the code editor, click at the end of the comment, press Enter, and then type the following code: </p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">bool</span> <span class="token function">VerifyPassword</span><span class="token punctuation">(</span><span class="token keyword">string</span> pass<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>pass<span class="token punctuation">,</span> _password<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public bool VerifyPassword(string pass)
{
   return (String.Compare(pass, _password) == 0);
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
</ol>
<h5 id="task-2-modify-the-student-and-teacher-classes-to-inherit-from-the-user-class">Task 2: Modify the Student and Teacher classes to inherit from the User class.</h5>
<ol>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 2a: Inherit from the User class</strong> task.</p></li>
<li><p>In the code editor, modify the statement below this comment as shown below in bold:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">:</span> <span class="token class-name">User</span><span class="token punctuation">,</span> IComparable<span class="token operator">&lt;</span>Student<span class="token operator">&gt;</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public class Student: User, IComparable&lt;Student&gt;" class="paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 2b: Remove the UserName property (now inherited from User)</strong> task.</p></li>
<li><p>In the code editor, delete the following statement from below the comment:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">string</span> UserName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public string UserName { get; set; }" class="paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 2c: Remove the Password property (now inherited from User)</strong> task.</p></li>
<li><p>In the code editor, delete the following block of code from below the comment:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">private</span> <span class="token keyword">string</span> _password <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Generate a random password by default</span>
<span class="token keyword">public</span> <span class="token keyword">string</span> Password
<span class="token punctuation">{</span>
    <span class="token keyword">set</span>
    <span class="token punctuation">{</span>
        _password <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="private string _password = Guid.NewGuid().ToString(); // Generate a random password by default
public string Password
{
    set
    {
        _password = value;
    }
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 2d Remove the VerifyPassword method (now inherited from User)</strong> task.</p></li>
<li><p>In the code editor, delete the following method from below the comment:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">bool</span> <span class="token function">VerifyPassword</span><span class="token punctuation">(</span><span class="token keyword">string</span> pass<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>pass<span class="token punctuation">,</span> _password<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public bool VerifyPassword(string pass)
{
    return (String.Compare(pass, _password) == 0);
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 2e: Inherit from the User class</strong> task. </p></li>
<li><p>In the code editor, modify the statement below this comment as shown below in bold: </p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Teacher</span><span class="token punctuation">:</span> <span class="token class-name">User</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public class Teacher: User" class="paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 2f: Remove the UserName property (now inherited from User)</strong> task. </p></li>
<li><p>In the code editor, delete the following statement from below the comment: </p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">string</span> UserName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public string UserName { get; set; }" class="paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 2g: Remove the Password property (now inherited from User)</strong> task. </p></li>
<li><p>In the code editor, delete the following block of code from below the comment: </p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">private</span> <span class="token keyword">string</span> _password <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Generate a random password by default</span>
<span class="token keyword">public</span> <span class="token keyword">string</span> Password
<span class="token punctuation">{</span>
    <span class="token keyword">set</span>
    <span class="token punctuation">{</span>
        _password <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="private string _password = Guid.NewGuid().ToString(); // Generate a random password by default
public string Password
{
    set
    {
        _password = value;
    }
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 1: Task 2h Remove the VerifyPassword method (now inherited from User)</strong> task. </p></li>
<li><p>In the code editor, delete the following method from below the comment: </p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">bool</span> <span class="token function">VerifyPassword</span><span class="token punctuation">(</span><span class="token keyword">string</span> pass<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>pass<span class="token punctuation">,</span> _password<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public bool VerifyPassword(string pass)
{
    return (String.Compare(pass, _password) == 0);
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
</ol>
<h5 id="task-3-run-the-application-and-test-the-log-on-functionality">Task 3: Run the application and test the log on functionality</h5>
<ol>
<li><p>On the <strong>Build</strong> menu, click <strong>Build Solution</strong>.</p></li>
<li><p>On the <strong>Debug</strong> menu, click <strong>Start Without Debugging</strong>.</p></li>
<li><p>When the application starts, in the <strong>Username</strong> text box, type <strong>vallee</strong>, in the <strong>Password</strong> text box, type <strong>password</strong>, and then click <strong>Log on</strong>.</p></li>
<li><p>Verify that the list of students for teacher <strong>Esther Valle</strong> is displayed.</p></li>
<li><p>Click <strong>Kevin Liu</strong>, and verify that the report card with the grades for <strong>Kevin Liu</strong> is displayed.</p></li>
<li><p>Click <strong>Log off</strong>.</p></li>
<li><p>In the <strong>Username</strong> text box, type <strong>liuk</strong>, in the <strong>Password</strong> text box, type <strong>password</strong>, and then click <strong>Log on</strong>.</p></li>
<li><p>Verify that the report card showing the grades for <strong>Kevin Liu</strong> is displayed again.</p></li>
<li><p>Click <strong>Log off</strong>.</p></li>
<li><p>Close the application.</p></li>
<li><p>In <strong>Visual Studio</strong>, on the <strong>File</strong> menu, click <strong>Close Solution</strong>.</p></li>
</ol>
<div class=" alert alert-success"><p><strong>Result:</strong> After completing this exercise, you should have removed the duplicated code from the <strong>Student</strong> and <strong>Teacher</strong> classes, and moved the code to an abstract base class called <strong>User</strong>.</p></div>
<h4 id="exercise-2-implementing-password-complexity-by-using-an-abstract-method">Exercise 2: Implementing Password Complexity by Using an Abstract Method</h4>
<div class=" alert alert-secondary"><p><strong>Scenario</strong></p>
<p>In this exercise, you will add an abstract method called SetPassword to the User class.<br>
In the Teacher and Student classes, you will implement the SetPassword method. This method will set the password for the user (either a teacher or a student).</p>
<ul>
<li>The SetPassword method for a teacher will check that the password is at least eight characters long and contains at least two numeric characters.</li>
<li>The SetPassword method for a student will check that the password is at least six characters long. If the password meets these requirements, it is set and the method will return true; otherwise, it will return false.</li>
<li>You will then modify the set accessor of the Password property in the User class to call the SetPassword method to change the user's password.</li>
<li>Next, you will integrate this feature into the user interface of the application to enable a user to change their password.<br>
Finally, you will build and run the application to test the password functionality.</li>
</ul></div>
<h5 id="task-1-define-the-setpassword-abstract-method">Task 1: Define the SetPassword abstract method</h5>
<ol>
<li><p>In <strong>Visual Studio</strong>, on the <strong>File</strong> menu, point to <strong>Open</strong>, and then click <strong>Project/Solution</strong>.</p></li>
<li><p>In the <strong>Open Project</strong> dialog box, browse to <strong>[Repository Root]\Allfiles\Mod05\Labfiles\Starter\Exercise 2</strong>, click <strong>GradesPrototype.sln</strong>, and then click <strong>Open</strong>.</p><div class=" alert alert-warning"><p><strong>Note :</strong> If any Security warning dialog box appears, clear <strong>Ask me for every project in this solution</strong> check box and then click <strong>OK</strong>.</p></div><p></p></li>
<li><p>In <strong>Visual Studio</strong>, on the <strong>View</strong> menu, click <strong>Task List</strong>.</p></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 1a: Define an abstract method for setting the password</strong> task.</p></li>
<li><p>In the code editor, review the comment below this line, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">bool</span> <span class="token function">SetPassword</span><span class="token punctuation">(</span><span class="token keyword">string</span> pwd<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public abstract bool SetPassword(string pwd);" class="paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 1b: Use the SetPassword method to set the password</strong> task.</p></li>
<li><p>In the code editor, delete the following statement:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp">_password <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-paster-rows"><span data-code="_password = value;" class="paste"></span></span></code></pre></li>
<li><p>Add the following block of code in the place of the statement that you just deleted:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">SetPassword</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ArgumentException</span><span class="token punctuation">(</span><span class="token string">"Password not complex enough"</span><span class="token punctuation">,</span> <span class="token string">"Password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="if (!SetPassword(value))
{
    throw new ArgumentException(&quot;Password not complex enough&quot;, &quot;Password&quot;);
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
</ol>
<h5 id="task-2-implement-the-setpassword-method-in-the-student-and-teacher-classes">Task 2: Implement the SetPassword method in the Student and Teacher classes</h5>
<ol>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 2a: Make _password a protected field rather than private</strong> task.</p></li>
<li><p>In the code editor, modify the statement below the comment as shown below in bold:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">protected</span> <span class="token keyword">string</span> _password <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Generate a random password by default</span><span aria-hidden="true" class="line-paster-rows"><span data-code="protected string _password = Guid.NewGuid().ToString(); // Generate a random password by default" class="paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 2b: Implement SetPassword to set the password for the student</strong> task.</p></li>
<li><p>In the code editor, review the comment below this line, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token keyword">bool</span> <span class="token function">SetPassword</span><span class="token punctuation">(</span><span class="token keyword">string</span> pwd<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// If the password provided as the parameter is at least 6 characters long then save it and return true</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pwd<span class="token punctuation">.</span>Length <span class="token operator">&gt;=</span> <span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _password <span class="token operator">=</span> pwd<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// If the password is not long enough, then do not save it and return false</span>
    <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public override bool SetPassword(string pwd)
{
    // If the password provided as the parameter is at least 6 characters long then save it and return true
    if (pwd.Length &gt;= 6)
    {
        _password = pwd;
        return true;
    }
    // If the password is not long enough, then do not save it and return false
    return false;
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 2c: Implement SetPassword to set the password for the teacher</strong> task.</p></li>
<li><p>In the code editor, review the comment below this line, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token keyword">bool</span> <span class="token function">SetPassword</span><span class="token punctuation">(</span><span class="token keyword">string</span> pwd<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Use a regular expression to check that the password contains at least two numeric characters</span>
    <span class="token class-name">Match</span> numericMatch <span class="token operator">=</span> Regex<span class="token punctuation">.</span><span class="token function">Match</span><span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> <span class="token string">@".*[0-9]+.*[0-9]+.*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// If the password provided as the parameter is at least 8 characters long and contains at least two numeric characters then save it and return true</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>pwd<span class="token punctuation">.</span>Length <span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">&amp;</span>amp<span class="token punctuation">;</span><span class="token operator">&amp;</span>amp<span class="token punctuation">;</span> numericMatch<span class="token punctuation">.</span>Success<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    _password <span class="token operator">=</span> pwd<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// If the password is not complex enough, then do not save it and return false</span>
<span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public override bool SetPassword(string pwd)
{
    // Use a regular expression to check that the password contains at least two numeric characters
    Match numericMatch = Regex.Match(pwd, @&quot;.*[0-9]+.*[0-9]+.*&quot;);// If the password provided as the parameter is at least 8 characters long and contains at least two numeric characters then save it and return true
if (pwd.Length &amp;gt;= 8 &amp;amp;&amp;amp; numericMatch.Success)
{
    _password = pwd;
    return true;
}
// If the password is not complex enough, then do not save it and return false
return false;}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
</ol>
<h5 id="task-3-set-the-password-for-a-new-student">Task 3: Set the password for a new student</h5>
<ol>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 3a: Use the SetPassword method to set the password.</strong> task.</p></li>
<li><p>In the code editor, delete the statement below this comment and replace it with the following block of code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>newStudent<span class="token punctuation">.</span><span class="token function">SetPassword</span><span class="token punctuation">(</span>sd<span class="token punctuation">.</span>password<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"Password must be at least 6 characters long. Student not created"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="if (!newStudent.SetPassword(sd.password.Text))
{
    throw new Exception(&quot;Password must be at least 6 characters long. Student not created&quot;);
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
</ol>
<h5 id="task-4-change-the-password-for-an-existing-user">Task 4: Change the password for an existing user</h5>
<ol>
<li><p>On the <strong>Build</strong> menu, click <strong>Build Solution</strong>.</p></li>
<li><p>In <strong>Solution Explorer</strong>, expand the <strong>GradesPrototype</strong> project, and then double-click <strong>MainWindow.xaml</strong>.</p></li>
<li><p>In the XAML editor, scroll down to line 27 and review the following block of XAML code:</p>
<pre class="single-paste line-paster language-xml"><code class="xml  language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">Grid.Column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">Margin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">HorizontalAlignment</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Right<span class="token punctuation">"</span></span> <span class="token attr-name">Click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ChangePassword_Click<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextBlock</span> <span class="token attr-name">Text</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Change Password<span class="token punctuation">"</span></span> <span class="token attr-name">FontSize</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>24<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-paster-rows"><span data-code="&lt;Button Grid.Column=&quot;2&quot; Margin=&quot;5&quot; HorizontalAlignment=&quot;Right&quot; Click=&quot;ChangePassword_Click&quot;&gt;
    &lt;TextBlock Text=&quot;Change Password&quot; FontSize=&quot;24&quot;/&gt;
&lt;/Button&gt;" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In <strong>Solution Explorer</strong>, expand <strong>MainWindow.xaml</strong> and then double-click <strong>MainWindow.xaml.csharp</strong>.</p></li>
<li><p>In the code editor, expand the <strong>Event Handlers</strong> region, and locate the <strong>ChangePassword_Click</strong>method.</p></li>
<li><p>Review the code in this method:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ChangePassword_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Use the ChangePasswordDialog to change the user's password</span>
    <span class="token class-name">ChangePasswordDialog</span> cpd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChangePasswordDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Display the dialog</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>cpd<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// When the user closes the dialog by using the OK button, the password should have been changed</span>
    <span class="token comment">// Display a message to confirm</span>
    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"Password changed"</span><span class="token punctuation">,</span> <span class="token string">"Password"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>            <span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="private void ChangePassword_Click(object sender, EventArgs e)
{
    // Use the ChangePasswordDialog to change the user&#39;s password
    ChangePasswordDialog cpd = new ChangePasswordDialog();// Display the dialog
if (cpd.ShowDialog().Value)
{
    // When the user closes the dialog by using the OK button, the password should have been changed
    // Display a message to confirm
    MessageBox.Show(&quot;Password changed&quot;, &quot;Password&quot;, MessageBoxButton.OK, MessageBoxImage.Information);
}            }" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In <strong>Solution Explorer</strong>, expand <strong>Controls</strong>, and then double-click <strong>ChangePasswordDialog.xaml</strong>.</p></li>
<li><p>In <strong>Solution Explorer</strong>, expand <strong>ChangePasswordDialog.xaml</strong> and then double-click <strong>ChangePasswordDialog.xaml.csharp</strong>.</p></li>
<li><p>Review the code in the <strong>ok_Click</strong> method:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token comment">// If the user clicks OK to change the password, validate the information that the user has provided</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ok_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// TODO: Exercise 2: Task 4a: Get the details of the current user// TODO: Exercise 2: Task 4b: Check that the old password is correct for the current user</span>

<span class="token comment">// TODO: Exercise 2: Task 4c: Check that the new password and confirm password fields are the same</span>

<span class="token comment">// TODO: Exercise 2: Task 4d: Attempt to change the password</span>
<span class="token comment">// If the password is not sufficiently complex, display an error message</span>

<span class="token comment">// Indicate that the data is valid</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>DialogResult <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="// If the user clicks OK to change the password, validate the information that the user has provided
private void ok_Click(object sender, RoutedEventArgs e)
{
    // TODO: Exercise 2: Task 4a: Get the details of the current user// TODO: Exercise 2: Task 4b: Check that the old password is correct for the current user

// TODO: Exercise 2: Task 4c: Check that the new password and confirm password fields are the same

// TODO: Exercise 2: Task 4d: Attempt to change the password
// If the password is not sufficiently complex, display an error message

// Indicate that the data is valid
this.DialogResult = true;}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 4a: Get the details of the current user</strong> task.</p></li>
<li><p>In the code editor, in the blank line below this comment, type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token class-name">User</span> currentUser<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>SessionContext<span class="token punctuation">.</span>UserRole <span class="token operator">==</span> Role<span class="token punctuation">.</span>Teacher<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    currentUser <span class="token operator">=</span> SessionContext<span class="token punctuation">.</span>CurrentTeacher<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{</span>
    currentUser <span class="token operator">=</span> SessionContext<span class="token punctuation">.</span>CurrentStudent<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="User currentUser;
if (SessionContext.UserRole == Role.Teacher)
{
    currentUser = SessionContext.CurrentTeacher;
}
else
{
    currentUser = SessionContext.CurrentStudent;
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 4b: Check that the old password is correct for the current user</strong> task.</p></li>
<li><p>In the code editor, in the blank line below this comment, type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">string</span> oldPwd <span class="token operator">=</span> oldPassword<span class="token punctuation">.</span>Password<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>currentUser<span class="token punctuation">.</span><span class="token function">VerifyPassword</span><span class="token punctuation">(</span>oldPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"Old password is incorrect"</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="string oldPwd = oldPassword.Password;
if (!currentUser.VerifyPassword(oldPwd))
{
    MessageBox.Show(&quot;Old password is incorrect&quot;, &quot;Error&quot;, MessageBoxButton.OK, MessageBoxImage.Error);
    return;
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 4c: Check that the new password and confirm password fields are the same</strong> task.</p></li>
<li><p>In the code editor, in the blank line below this comment, type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">string</span> newPwd <span class="token operator">=</span> newPassword<span class="token punctuation">.</span>Password<span class="token punctuation">;</span>
    <span class="token keyword">string</span> confirmPwd <span class="token operator">=</span> confirm<span class="token punctuation">.</span>Password<span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">Compare</span><span class="token punctuation">(</span>newPwd<span class="token punctuation">,</span> confirmPwd<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"The new password and confirm password fields are different"</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="string newPwd = newPassword.Password;
    string confirmPwd = confirm.Password;

if (String.Compare(newPwd, confirmPwd) != 0)
{
    MessageBox.Show(&quot;The new password and confirm password fields are different&quot;, &quot;Error&quot;, MessageBoxButton.OK, MessageBoxImage.Error);
    return;
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 2: Task 4d: Attempt to change the password</strong> task.</p></li>
<li><p>In the code editor, review the comment below this line, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>currentUser<span class="token punctuation">.</span><span class="token function">SetPassword</span><span class="token punctuation">(</span>newPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"The new password is not sufficiently complex"</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="if (!currentUser.SetPassword(newPwd))
{
    MessageBox.Show(&quot;The new password is not sufficiently complex&quot;, &quot;Error&quot;, MessageBoxButton.OK, MessageBoxImage.Error);
    return;
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
</ol>
<h5 id="task-5-run-the-application-and-test-the-change-password-functionality">Task 5: Run the application and test the change password functionality</h5>
<ol>
<li><p>On the <strong>Build</strong> menu, click <strong>Build Solution</strong>.</p></li>
<li><p>On the <strong>Debug</strong> menu, click <strong>Start Without Debugging</strong>.</p></li>
<li><p>When the application starts, in the <strong>Username</strong> text box, type <strong>vallee</strong>, in the <strong>Password</strong> text box, type <strong>password99</strong>, and then click <strong>Log on</strong>.</p></li>
<li><p>In the <strong>The School of Fine Arts</strong> window, click <strong>Change Password</strong>.</p></li>
<li><p>In the <strong>Change Password Dialog</strong> window, in the <strong>Old Password</strong> text box, type <strong>password99</strong>, in the <strong>New Password</strong> text box, type <strong>pwd101</strong>, in the <strong>Confirm</strong> text box, type <strong>pwd101</strong>, and then click <strong>OK</strong>.</p></li>
<li><p>Verify that the message <strong>The new password is not sufficiently complex</strong> is displayed, and then click <strong>OK</strong>.</p></li>
<li><p>In the <strong>New Password</strong> text box, type <strong>password101</strong>, in the <strong>Confirm</strong> text box, type <strong>password101</strong>, and then click <strong>OK</strong>.</p></li>
<li><p>Verify that the message <strong>Password changed</strong> is displayed, and then click <strong>OK</strong>.</p></li>
<li><p>Click <strong>Log off</strong>.</p></li>
<li><p>In the <strong>Username</strong> text box, type <strong>vallee</strong>, in the <strong>Password</strong> text box, type <strong>password101</strong>, and then click <strong>Log on</strong>.</p></li>
<li><p>Click <strong>New Student</strong>.</p></li>
<li><p>In the <strong>New Student Details</strong> window, in the <strong>First Name</strong> text box, type <strong>Luka</strong>, in the <strong>Last Name</strong> text box, type <strong>Abrus</strong>, in the <strong>Password</strong> text box, type <strong>1234</strong>, and then click <strong>OK</strong>.</p></li>
<li><p>Verify that the message <strong>Password must be at least 6 characters long. Student not created</strong> appears, and then click <strong>OK</strong>.</p></li>
<li><p>Click <strong>New Student</strong>.</p></li>
<li><p>In the <strong>New Student Details</strong> window, in the <strong>First Name</strong> text box, type <strong>Luka</strong>, in the <strong>Last Name</strong> text box, type <strong>Abrus</strong>, in the <strong>Password</strong> text box, type <strong>abcdef</strong>, and then click <strong>OK</strong>.</p></li>
<li><p>Click <strong>Enroll Student</strong>.</p></li>
<li><p>In the <strong>Assign Student</strong> window, verify that the student <strong>Luka Abrus</strong> appears.</p></li>
<li><p>Click <strong>Close</strong>.</p></li>
<li><p>Click <strong>Log off</strong>.</p></li>
<li><p>Close the application.</p></li>
<li><p>In <strong>Visual Studio</strong>, on the <strong>File</strong> menu, click <strong>Close Solution</strong>.</p></li>
</ol>
<div class=" alert alert-success"><p><strong>Result:</strong> After completing this exercise, you should have implemented a polymorphic method named <strong>SetPassword</strong> that changes behavior based on whether the user is a student or s teacher. You will also have modified the application to enable users to change their passwords.</p></div>
<h4 id="exercise-3-creating-the-classfullexception-custom-exception">Exercise 3: Creating the ClassFullException Custom Exception</h4>
<div class=" alert alert-secondary"><p><strong>Scenario</strong><br>
In this exercise, you will create a new custom exception class called ClassFullException.</p>
<ul>
<li>You will modify the EnrollInClass method of the Teacher class to raise this exception if too many students are added to a teacher's class.</li>
<li>You will update the application to catch this exception, and then you will build and run the application to test this feature.</li>
</ul></div>
<h5 id="task-1-implement-the-classfullexception-class">Task 1: Implement the ClassFullException class.</h5>
<ol>
<li><p>In <strong>Visual Studio</strong>, on the <strong>File</strong> menu, point to <strong>Open</strong>, and then click <strong>Project/Solution</strong>.</p></li>
<li><p>In the <strong>Open Project</strong> dialog box, browse to <strong>[Repository Root]\Allfiles\Mod05\Labfiles\Starter\Exercise 3</strong>, click <strong>GradesPrototype.sln</strong>, and then click <strong>Open</strong>.</p><div class=" alert alert-warning"><p><strong>Note :</strong> If any Security warning dialog box appears, clear <strong>Ask me for every project in this solution</strong> check box and then click <strong>OK</strong>.</p></div><p></p></li>
<li><p>In <strong>Visual Studio</strong>, on the <strong>View</strong> menu, click <strong>Task List</strong>.</p></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 3: Task 1a: Add custom data: the name of the class that is full</strong> task.</p></li>
<li><p>In the code editor, review the comment below this task, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">private</span> <span class="token keyword">string</span> _className<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">virtual</span> <span class="token keyword">string</span> ClassName
<span class="token punctuation">{</span>
    <span class="token keyword">get</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> _className<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="private string _className;
public virtual string ClassName
{
    get
    {
        return _className;
    }
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 3: Task 1b: Delegate functionality for the common constructors directly to the Exception class</strong> task.</p></li>
<li><p>In the code editor, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"> <span class="token keyword">public</span> <span class="token function">ClassFullException</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">ClassFullException</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span>
    <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">ClassFullException</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">,</span> <span class="token class-name">Exception</span> inner<span class="token punctuation">)</span>
    <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> inner<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code=" public ClassFullException()
{
}

public ClassFullException(string message)
    : base(message)
{
}

public ClassFullException(string message, Exception inner)
    : base(message, inner)
{
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 3: Task 1c: Add custom constructors that populate the _className field.</strong> task.</p></li>
<li><p>In the code editor, review the comment below this task, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">public</span> <span class="token function">ClassFullException</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">,</span> <span class="token keyword">string</span> cls<span class="token punctuation">)</span>
    <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    _className <span class="token operator">=</span> cls<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">ClassFullException</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">,</span> <span class="token keyword">string</span> cls<span class="token punctuation">,</span> <span class="token class-name">Exception</span> inner<span class="token punctuation">)</span>
    <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> inner<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    _className <span class="token operator">=</span> cls<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="public ClassFullException(string message, string cls)
    : base(message)
{
    _className = cls;
}

public ClassFullException(string message, string cls, Exception inner)
    : base(message, inner)
{
    _className = cls;
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
</ol>
<h5 id="task-2-throw-and-catch-the-classfullexception">Task 2: Throw and catch the ClassFullException</h5>
<ol>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 3: Task 2a: Set the maximum class size for any teacher</strong> task.</p></li>
<li><p>In the code editor, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">int</span> MAX_CLASS_SIZE <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-paster-rows"><span data-code="private const int MAX_CLASS_SIZE = 8;" class="paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 3: Task 2b: If the class is already full, then another student cannot be enrolled</strong> task.</p></li>
<li><p>In the code editor, review the comment below this task, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">if</span> <span class="token punctuation">(</span>numStudents <span class="token operator">==</span> MAX_CLASS_SIZE<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Throw a ClassFullException and specify the class that is full</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ClassFullException</span><span class="token punctuation">(</span><span class="token string">"Class full: Unable to enroll student"</span><span class="token punctuation">,</span> Class<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="if (numStudents == MAX_CLASS_SIZE)
{
    // Throw a ClassFullException and specify the class that is full
    throw new ClassFullException(&quot;Class full: Unable to enroll student&quot;, Class);
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
<li><p>In the <strong>Task List</strong> window, double-click the <strong>TODO: Exercise 3: Task 2c: Catch and handle the ClassFullException</strong> task.</p></li>
<li><p>In the code editor, click at the end of the comment, press Enter, and then type the following code:</p>
<pre class="single-paste line-paster language-csharp"><code class="csharp  language-csharp"><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassFullException</span> cfe<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0}. Class: {1}"</span><span class="token punctuation">,</span> cfe<span class="token punctuation">.</span>Message<span class="token punctuation">,</span> cfe<span class="token punctuation">.</span>ClassName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Error enrolling student"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-paster-rows"><span data-code="catch (ClassFullException cfe)
{
    MessageBox.Show(String.Format(&quot;{0}. Class: {1}&quot;, cfe.Message, cfe.ClassName), &quot;Error enrolling student&quot;, MessageBoxButton.OK, MessageBoxImage.Error);
}" class="paste"></span><span class="no-paste"></span><span class="no-paste"></span><span class="no-paste"></span></span></code></pre></li>
</ol>
<h5 id="task-3-build-and-test-the-solution">Task 3: Build and test the solution.</h5>
<ol>
<li><p>On the <strong>Build</strong> menu, click <strong>Build Solution</strong>.</p></li>
<li><p>On the <strong>Debug</strong> menu, click <strong>Start Without Debugging</strong>.</p></li>
<li><p>When the application starts, in the <strong>Username</strong> text box, type <strong>vallee</strong>, in<br>
the <strong>Password</strong> text box, type <strong>password99</strong>, and then click <strong>Log on</strong>.</p></li>
<li><p>In <strong>The School of Fine Arts</strong> window, click <strong>New Student</strong>.</p></li>
<li><p>In the <strong>New Student Details</strong> window, enter the following details, and then click <strong>OK</strong>.</p>
<table>
<thead>
<tr>
<th id="**field**"><strong>Field</strong></th>
<th id="**value**" style="text-align:center;"><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>First Name</td>
<td style="text-align:center;"><strong>Walter</strong></td>
</tr>
<tr>
<td>Last Name</td>
<td style="text-align:center;"><strong>Harp</strong></td>
</tr>
<tr>
<td>Password</td>
<td style="text-align:center;"><strong>abcdef</strong></td>
</tr>
</tbody>
</table></li>
</ol>
<div class=" alert alert-warning"><p><strong>Note:</strong> New students will not be listed in the main application window because this displays students in the <strong>Users</strong> class, and the new students are yet to be assigned to a class.</p></div>
<ol start="6">
<li><p>In the <strong>The School of Fine Arts</strong> window, click <strong>New Student</strong>.</p></li>
<li><p>In the <strong>New Student Details</strong> window, enter the following details, and then click <strong>OK</strong>.</p>
<table>
<thead>
<tr>
<th id="**field**"><strong>Field</strong></th>
<th id="**value**" style="text-align:center;"><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>First Name</td>
<td style="text-align:center;"><strong>Andrew</strong></td>
</tr>
<tr>
<td>Last Name</td>
<td style="text-align:center;"><strong>Harris</strong></td>
</tr>
<tr>
<td>Password</td>
<td style="text-align:center;"><strong>abcdef</strong></td>
</tr>
</tbody>
</table></li>
<li><p>In the <strong>The School of Fine Arts</strong> window, click <strong>New Student</strong>.</p></li>
<li><p>In the <strong>New Student Details</strong> window, enter the following details, and then click <strong>OK</strong>.</p>
<table>
<thead>
<tr>
<th id="**field**"><strong>Field</strong></th>
<th id="**value**" style="text-align:center;"><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>First Name</td>
<td style="text-align:center;"><strong>Toni</strong></td>
</tr>
<tr>
<td>Last Name</td>
<td style="text-align:center;"><strong>Poe</strong></td>
</tr>
<tr>
<td>Password</td>
<td style="text-align:center;"><strong>abcdef</strong></td>
</tr>
</tbody>
</table></li>
<li><p>In the <strong>The School of Fine Arts</strong> window, click <strong>New Student</strong>.</p></li>
<li><p>In the <strong>New Student Details</strong> window, enter the following details, and then click <strong>OK</strong>.</p>
<table>
<thead>
<tr>
<th id="**field**"><strong>Field</strong></th>
<th id="**value**" style="text-align:center;"><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>First Name</td>
<td style="text-align:center;"><strong>Ben</strong></td>
</tr>
<tr>
<td>Last Name</td>
<td style="text-align:center;"><strong>Andrews</strong></td>
</tr>
<tr>
<td>Password</td>
<td style="text-align:center;"><strong>abcdef</strong></td>
</tr>
</tbody>
</table></li>
<li><p>In the <strong>The School of Fine Arts</strong> window, click <strong>Enroll Student</strong>.</p></li>
<li><p>In the <strong>Assign Student</strong> window, click <strong>Walter Harp</strong>.</p></li>
<li><p>In the <strong>Confirm</strong> message box, click <strong>Yes</strong>.</p></li>
<li><p>In the <strong>Assign Student</strong> window, click <strong>Andrew Harris</strong>.</p></li>
<li><p>In the <strong>Confirm</strong> message box, click <strong>Yes</strong>.</p></li>
<li><p>In the <strong>Assign Student</strong> window, click <strong>Toni Poe</strong>.</p></li>
<li><p>In the <strong>Confirm</strong> message box, click <strong>Yes</strong>.</p></li>
<li><p>In the <strong>Assign Student</strong> window, click <strong>Ben Andrews</strong>.</p></li>
<li><p>In the <strong>Confirm</strong> message box, click <strong>Yes</strong>.</p></li>
<li><p>Verify that the message <strong>Class full: Unable to enroll student: Class: 3C</strong> is displayed, and then click <strong>OK</strong>.</p></li>
<li><p>In the <strong>Assign Student</strong> window, click <strong>Close</strong>.</p></li>
<li><p>Click <strong>Log off</strong>.</p></li>
<li><p>Close the application.</p></li>
<li><p>In <strong>Visual Studio</strong>, on the <strong>File</strong> menu, click <strong>Close Solution</strong>.</p></li>
</ol>
<div class=" alert alert-success"><p><strong>Result:</strong> After completing this exercise, you should have created a new custom exception class and used it to report when too many students are enrolled in a class.</p></div>
<div class=" alert alert-info"><p><strong>Congratulations!</strong>  You have now completed this lab.  You should ensure you save your lab environment.  Failure to do so will result in the loss of all work.</p></div></div>
    </div>
    <div id="labGuidePoppedOutContainer" class="text-center" style="display:none;">
        <p>Your lab guide is open in another window</p>
        <p class="text-muted"><i class="fal fa-window fa-9x"></i></p>
        <p><button class="btn btn-brand d-block w-100 focus-popout-btn">Show Lab Guide</button></p>
    </div>
</div>


                        <div class="lab-timer text-center bg-light p-2" id="lab-timer-container">
                <div class="position-relative h-100 w-100" id="lab-timer-warning" data-original-title="" title="">
                    <h2><span class="badge badge-secondary style colorDefinition size_lg" id="lab-timer">
                        <i class="fas fa-stopwatch" id="stopwatch" data-toggle="popover" data-content="Time Remaining" data-trigger="hover" data-placement="top" data-original-title="" title=""></i>
                        <span id="lab-timer-timer">07:55:35</span>
                    </span></h2>
                </div>
            </div>

        </div>
        <div class="gutter gutter-horizontal" style="flex-basis: 6px;"></div><div class="col bg-dark" style="overflow: auto; flex-basis: calc(32.0304% - 3px);" id="lab-display-container">
            <div style="position: absolute; top: 0; left: 0; height: 100%; width: 100%; z-index: 1;">
    <div class="d-flex align-items-center justify-content-center" style="height: 100%; overflow: hidden" id="outer-display">

        <div class="card border-warning connection-error-box" id="display-error-checking" style="display: none;">
            <div class="card-header bg-warning border-0 text-white">Sorry, there was a problem connecting to your VM</div>
            <div class="card-body text-center">
                <p>We're checking your connection, please wait...</p>
            </div>
        </div>

        <div class="card border-danger connection-error-box" id="display-error" style="display: none;">
            <div class="card-header bg-danger border-0 text-white">Sorry, there was a problem connecting to your VM</div>
            <div class="card-body text-center">
                <button class="btn btn-sm btn-outline-secondary ml-1 reconnect-display-btn">Reconnect</button>
            </div>
        </div>

        <div class="card border-danger connection-error-box" id="display-error-contact" style="display: none;">
            <div class="card-header bg-danger border-0 text-white">Unexpected VM State</div>
            <div class="card-body text-center">
                <p>Your VM is in an unexpected state. Please <a href="mailto:support@godeploy.it">contact support</a>.</p>
            </div>
        </div>

        <div class="card border-primary connection-error-box" id="display-error-stopped" style="display: none;">
            <div class="card-header bg-primary border-0 text-white">Your VM is turned off</div>
            <div class="card-body text-center">
                <button class="btn btn-sm btn-outline-secondary ml-1 power-op" data-op="start">Power on</button>
            </div>
        </div>

        <div class="card border-primary connection-error-box" id="display-error-starting" style="display: none;">
            <div class="card-header bg-primary border-0 text-white">Your VM is turning on</div>
            <div class="card-body text-center">
                <p>Your VM is turning on, please wait...</p>
            </div>
        </div>

        <div class="card border-primary connection-error-box" id="display-error-stopping" style="display: none;">
            <div class="card-header bg-primary border-0 text-white">Your VM is turning off</div>
            <div class="card-body text-center">
                <p>Your VM is turning off, please wait...</p>
            </div>
        </div>

        <div id="display" class="position-relative">
            <div style="position: absolute; top: 0; left: 0; background-color: #000; z-index: -2; height: 100%;width:100%"></div>
        <div style="position: relative; width: 1024px; height: 768px;"><div style="position: relative; width: 1024px; height: 768px; transform-origin: 0px 0px;"><div style="width: 1024px; height: 768px; position: absolute; left: 0px; top: 0px; overflow: hidden;"><canvas width="1024" height="768" style="z-index: -1; position: absolute; left: 0px; top: 0px;"></canvas></div><div style="width: 32px; height: 32px; position: absolute; left: 0px; top: 0px; overflow: hidden; transform: translate(-15px, -15px) matrix(1, 0, 0, 1, 0, 0);"><canvas width="64" height="64" style="z-index: -1; position: absolute; left: 0px; top: 0px;"></canvas></div></div></div></div>
    </div>
</div>

        </div>
    </div>
</main>

<div class="modal" tabindex="-1" role="dialog" id="end-lab-modal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header bg-warning text-white">
                <h5 class="modal-title">Warning - you are about to end your lab</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                    <p>Any change you have made to your lab will be irrevocably lost and you will need to start again.</p>
                    <p class="mb-0">You can, instead, save your lab and then continue from where you left off, later.</p>
            </div>
            <div class="modal-footer">
                    <a href="https://lms.godeploy.it/Modules/SaveLab/f2def404-29f7-e911-abe3-00155de2c913" class="btn btn-link text-success confirmed-navigation">Save my Lab</a>
                <a href="https://lms.godeploy.it/Modules/EndLab/f2def404-29f7-e911-abe3-00155de2c913" class="btn btn-danger confirmed-navigation" id="end-lab-btn">End my lab</a>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>

    <div class="modal" tabindex="-1" role="dialog" id="save-lab-modal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h5 class="modal-title">Save your lab</h5>
                    <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"></span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you wish to leave?</p>
                    <p>Your lab will be saved for 7 days, after which it will be stopped and deleted.</p>
                </div>
                <div class="modal-footer">
                    <a href="https://lms.godeploy.it/Modules/SaveLab/f2def404-29f7-e911-abe3-00155de2c913" class="btn btn-success confirmed-navigation">Save my Lab</a>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" tabindex="-1" role="dialog" id="launch-info-modal" data-show="true" aria-hidden="true" style="display: none;">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-warning text-white">
                    <h5 class="modal-title">Important information about your lab</h5>
                    <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"></span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>When launching Visual Studio you must sign in with a Microsoft Account or create a new one.&nbsp; The Visual Studio Community Edition trial has expired and is to be expected.</p>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="info-modal-ok-btn">Ok</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" tabindex="-1" role="dialog" id="launch-errata-modal" data-show="false">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-warning text-white">
                    <h5 class="modal-title">Important information about your lab</h5>
                    <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"></span>
                    </button>
                </div>
                <div class="modal-body">
                    <p><br></p>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="info-modal-ok-btn">Ok</button>
                </div>
            </div>
        </div>
    </div>

<div class="modal" tabindex="-1" role="dialog" id="screenshot-modal">
    <div class="modal-dialog modal-lg" role="document" style="max-width: 1024px;">
        <div class="modal-content">
            <div class="modal-body" id="screenshot-background" style="background-position: center center; background-repeat: no-repeat; background-size: auto 100%; height: 768px;">
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </div>
</div>

<div class="modal" tabindex="-1" role="dialog" id="lab_ui_lab-dns-modal" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">DNS Record</h5>
            </div>
            <div class="modal-body">
                <form id="lab_ui_a-record-form" class="dns-record-form" action="https://lms.godeploy.it/LabDomains/AddEditARecord/f2def404-29f7-e911-abe3-00155de2c913">
                    <div>
                        <input type="hidden" name="RecordSetId">
                        <input type="hidden" name="RecordId">
                        <input type="hidden" name="Delete" class="dns-record-delete-flag">
                        <div class="form-group">
                            <label for="dns-a-record-name-input">Name</label>
                            <input id="dns-a-record-name-input" class="form-control" name="Name">
                            <div class="text-right"><small class="text-muted">.<span class="dns-zone-name"></span></small></div>
                        </div>
                        <div class="form-group">
                            <label for="dns-a-record-ipv4address-input">IPv4 Address</label>
                            <input id="dns-a-record-ipv4address-input" class="form-control" name="Ipv4Address">
                        </div>
                    </div>
                </form>
                <form id="lab_ui_aaaa-record-form" class="dns-record-form" action="https://lms.godeploy.it/LabDomains/AddEditAaaaRecord/f2def404-29f7-e911-abe3-00155de2c913">
                    <div>
                        <input type="hidden" name="RecordSetId">
                        <input type="hidden" name="RecordId">
                        <input type="hidden" name="Delete" class="dns-record-delete-flag">
                        <div class="form-group">
                            <label for="dns-aaaa-record-name-input">Name</label>
                            <input id="dns-aaaa-record-name-input" class="form-control" name="Name">
                            <div class="text-right"><small class="text-muted">.<span class="dns-zone-name"></span></small></div>
                        </div>
                        <div class="form-group">
                            <label for="dns-aaaa-record-ipv6address-input">IPv6 Address</label>
                            <input id="dns-aaaa-record-ipv6address-input" class="form-control" name="Ipv6Address">
                        </div>
                    </div>
                </form>
                <form id="lab_ui_cname-record-form" class="dns-record-form" action="https://lms.godeploy.it/LabDomains/AddEditCnameRecord/f2def404-29f7-e911-abe3-00155de2c913">
                    <div>
                        <input type="hidden" name="RecordSetId">
                        <input type="hidden" name="RecordId">
                        <input type="hidden" name="Delete" class="dns-record-delete-flag">
                        <div class="form-group">
                            <label for="dns-cname-record-name-input">Name</label>
                            <input id="dns-cname-record-name-input" class="form-control" name="Name">
                            <div class="text-right"><small class="text-muted">.<span class="dns-zone-name"></span></small></div>
                        </div>
                        <div class="form-group">
                            <label for="dns-cname-record-cname-input">CNAME</label>
                            <input id="dns-cname-record-cname-input" class="form-control" name="Cname">
                        </div>
                    </div>
                </form>
                <form id="lab_ui_mx-record-form" class="dns-record-form" action="https://lms.godeploy.it/LabDomains/AddEditMxRecord/f2def404-29f7-e911-abe3-00155de2c913">
                    <div>
                        <input type="hidden" name="RecordSetId">
                        <input type="hidden" name="RecordId">
                        <input type="hidden" name="Delete" class="dns-record-delete-flag">
                        <div class="form-group">
                            <label for="dns-mx-record-name-input">Name</label>
                            <input id="dns-mx-record-name-input" class="form-control" name="Name">
                            <div class="text-right"><small class="text-muted">.<span class="dns-zone-name"></span></small></div>
                        </div>
                        <div class="row">
                            <div class="form-group col-6">
                                <label for="dns-mx-record-preference-input">Preference</label>
                                <input id="dns-mx-record-preference-input" class="form-control" name="Preference">
                            </div>
                            <div class="form-group col-18">
                                <label for="dns-mx-record-exchange-input">Host</label>
                                <input id="dns-mx-record-exchange-input" class="form-control" name="Exchange">
                            </div>
                        </div>
                    </div>
                </form>
                <form id="lab_ui_srv-record-form" class="dns-record-form" action="https://lms.godeploy.it/LabDomains/AddEditSrvRecord/f2def404-29f7-e911-abe3-00155de2c913">
                    <div>
                        <input type="hidden" name="RecordSetId">
                        <input type="hidden" name="RecordId">
                        <input type="hidden" name="Delete" class="dns-record-delete-flag">
                        <div class="form-group">
                            <label for="dns-srv-record-name-input">Name</label>
                            <input id="dns-srv-record-name-input" class="form-control" name="Name" placeholder="_service._protocol.name">
                            <div class="row">
                                <div class="col-12"><small class="text-muted">_service._protocol.name</small></div>
                                <div class="col-12 text-right"><small class="text-muted">.<span class="dns-zone-name"></span></small></div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-8">
                                <label for="dns-srv-record-priority-input">Priority</label>
                                <input id="dns-srv-record-priority-input" class="form-control" name="Priority">
                            </div>
                            <div class="form-group col-8">
                                <label for="dns-srv-record-weight-input">Weight</label>
                                <input id="dns-srv-record-weight-input" class="form-control" name="Weight">
                            </div>
                            <div class="form-group col-8">
                                <label for="dns-srv-record-port-input">Port</label>
                                <input id="dns-srv-record-port-input" class="form-control" name="Port">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="dns-srv-record-target-input">Target</label>
                            <input id="dns-srv-record-target-input" class="form-control" name="Target">
                        </div>
                    </div>
                </form>
                <form id="lab_ui_txt-record-form" class="dns-record-form" action="https://lms.godeploy.it/LabDomains/AddEditTxtRecord/f2def404-29f7-e911-abe3-00155de2c913">
                    <div>
                        <input type="hidden" name="RecordSetId">
                        <input type="hidden" name="RecordId">
                        <input type="hidden" name="Delete" class="dns-record-delete-flag">
                        <div class="form-group">
                            <label for="dns-txt-record-name-input">Name</label>
                            <input id="dns-txt-record-name-input" class="form-control" name="Name">
                            <div class="text-right"><small class="text-muted">.<span class="dns-zone-name"></span></small></div>
                        </div>
                        <div class="form-group">
                            <label for="dns-txt-record-value-input">Value</label>
                            <textarea id="dns-txt-record-value-input" class="form-control" name="Value"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger mr-auto" id="delete-dns-record-btn">Delete</button>
                <button type="button" class="btn btn-secondary" id="save-dns-record-btn">Save</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>




    <script src="./M20483C _ LAB 05_files/jquery.min.js.tlchargement"></script>
    <script src="./M20483C _ LAB 05_files/bootstrap.bundle.min.js.tlchargement"></script>
    
    <script src="./M20483C _ LAB 05_files/labs.js.tlchargement"></script>
    <script src="./M20483C _ LAB 05_files/all.min.js.tlchargement"></script>
    <script src="./M20483C _ LAB 05_files/easytimer.min.js.tlchargement"></script>
    <script src="./M20483C _ LAB 05_files/handlebars.min.js.tlchargement" integrity="sha256-dlwklXLDib5XGMYI+HdNEXczJXTsFtq+qIrSdXoCv6o=" crossorigin="anonymous"></script>
    <script type="text/x-handlebars-template" id="vm-credentials-template">
        {{#each this}}
            <table>
                <tr>
                    <th class="pr-2">Username</th>
                    <td>{{Username}}</td>
                    <td class="pl-2"><i class="fas fa-paste paste-credential paste-tab" data-text="{{Username}}"></i></td>
                </tr>
                <tr>
                    <th class="pr-2">Password</th>
                    <td>{{Password}}</td>
                    <td class="pl-2"><i class="fas fa-paste paste-credential paste-enter" data-text="{{Password}}"></i></td>
                </tr>
            </table>
        {{/each}}
    </script>
    <script type="text/javascript">
        window.focus();

        $('a.confirmed-navigation').on('click',
            function() {
                window.onbeforeunload = null;
            });

        var pasteBox = document.getElementById('paste-box');
        pasteBox.disabled = true;
        var pasteBoxOpen = false;

        $('#paste-box-dropdown').on('shown.bs.dropdown',
            function() {
                pasteBoxOpen = true;
                pasteBox.disabled = false;
                pasteBox.focus();
            });

        $('#paste-box-dropdown').on('hidden.bs.dropdown',
            function() {
                pasteBoxOpen = false;
                window.focus();
                pasteBox.value = '';
                pasteBox.disabled = true;
            });

        window.onbeforeunload = function(e) {
            return "If you navigate away from this page your changes may be lost and VMs deleted. We will try to save them for you.\n\nIt may be best to cancel navigation and click the \"End Lab\" or \"Save Lab\" button, instead.";
        };

        var pasteboxKbEvent = function(e) {
            if (document.activeElement !== pasteBox) return;

            client.guac.sendKeyEvent(0, 0xFFE3);
            client.guac.sendKeyEvent(0, 0xFFE9);

            e.stopPropagation();
            e.stopImmediatePropagation();
        };

        window.addEventListener('keydown', pasteboxKbEvent, true);
        window.addEventListener('keyup', pasteboxKbEvent, true);
        window.addEventListener('keypress', pasteboxKbEvent, true);

        document.addEventListener('paste',
            function(e) {
                if (document.activeElement !== pasteBox) {
                    return;
                }
                if (typeof e.clipboardData === 'undefined') {
                    var text = window.clipboardData.getData('Text');
                } else {
                    var text = e.clipboardData.getData('text/plain');
                }

                client.sendKeys(text);

                if (pasteBoxOpen) $('#paste-box-dropdown').dropdown('toggle');
            });

        var checkVmStateTimeout;
        
        function checkVmState(connecting) {
            $('.connection-error-box,#display').hide();
            $('#display-error-checking').show();

            if (checkVmStateTimeout) clearTimeout(checkVmStateTimeout);

            var vmId = $('#vm-dropdown-menu a.active').data('vmId');

            $.ajax({
                url: '/Labs/NVmControl/f2def404-29f7-e911-abe3-00155de2c913/' + vmId + '/get-state',
                type: 'get',
                success: function(data) {
                    $('.connection-error-box').hide();
                    switch(data) {
                    case 'stopped':
                    case 'saved':
                        $('#display-error-stopped').show();
                        break;
                    case 'starting':
                        $('#display-error-starting').show();
                        checkVmStateTimeout = setTimeout(function() { checkVmState(false); }, 2000);
                        break;
                    case 'stopping':
                        $('#display-error-stopping').show();
                        checkVmStateTimeout = setTimeout(function() { checkVmState(false); }, 2000);
                        break;
                    case 'saving':
                        $('#display-error-checking').show();
                        checkVmStateTimeout = setTimeout(function() { checkVmState(false); }, 2000);
                        break;
                    case 'started':
                        if (connecting) {
                            $('#display-error').show();
                        } else {
                            $('#vm-dropdown-menu a.active').triggerHandler('click');
                        }
                        break;
                    default:
                        $('#display-error-contact').show();
                        break;
                    }
                },
                error: function() {
                    $('#display-error-contact').show();
                }
            });
        }

        var envId = "f5def404-29f7-e911-abe3-00155de2c913";

        var Client = Client || {};

        Client.Rde = function(displayElement) {
            this.tunnelUrl = 'wss://remote.labsonline.it/wsTunnel';
            this.guac = null;
            this.mouse = null;
            this.keyboard = null;
            this.tunnel = null;
            this.enhancedMode = false;
            this.resizeTimeout = null;
            this.keysPressed = [];

            var KEYSYM_CTRL = 0xFFE3;
            var KEYSYM_ALT = 0xFFE9;
            var KEYSYM_DELETE = 0xFFFF;
            
            var self = this;
            
            var onkeydown = function(keysym) {
                self.guac.sendKeyEvent(1, keysym);
                self.registerKeypress(keysym);
            };

            var onkeyup = function(keysym) {
                self.guac.sendKeyEvent(0, keysym);
                self.unregisterKeypress(keysym);
            };

            this.initialize = function() {
                this.tunnel = new Guacamole.WebSocketTunnel(this.tunnelUrl);
                this.guac = new Guacamole.Client(this.tunnel);
                this.guac.onerror = function() {
                    self.enhancedMode = false;
                    $('#enhanced-mode-switch').prop('checked', false);
                    checkVmState(true);
                }

                window.onresize = function() {
                    if (self.resizeTimeout) window.clearTimeout(self.resizeTimeout);
                    self.resizeTimeout = window.setTimeout(function() {
                        window.clearTimeout(self.resizeTimeout);
                        if (self.enhancedMode) {
                            var outerOuterDisplay = document.getElementById('outer-display');
                            self.guac.sendSize(outerOuterDisplay.offsetWidth, outerOuterDisplay.offsetHeight);
                        }
                    }, 300);
                };
                
                displayElement.appendChild(this.guac.getDisplay().getElement());

                window.onunload = function() {
                    self.guac.disconnect();
                };

                this.mouse = new Guacamole.Mouse(this.guac.getDisplay().getElement());

                this.mouse.onmousedown = function(mouseState) {
                    self.guac.sendMouseState(mouseState);
                };
                this.mouse.onmouseup = function(mouseState) {
                    self.guac.sendMouseState(mouseState);
                };
                this.mouse.onmousemove = function(mouseState) {
                    self.guac.sendMouseState(mouseState);
                };

                this.keyboard = new Guacamole.Keyboard(document);
                this.captureKeyboard();
            };
            
            this.captureKeyboard = function() {
                this.keyboard.onkeyup = onkeyup;
                this.keyboard.onkeydown = onkeydown;
            }
            
            this.releaseKeyboard = function() {
                this.keyboard.onkeyup = null;
                this.keyboard.onkeydown = null;
            }
            
            this.registerKeypress = function(keysym) {
                this.keysPressed.push(keysym);
            }
            
            this.unregisterKeypress = function(keysym) {
                var index = this.keysPressed.indexOf(keysym);
                if (index === -1) return;
                this.keysPressed.splice(index, 1);
            }
            
            this.unregisterAllKeypresses = function() {
                var self = this;
                this.keysPressed.forEach(function(keysym) {
                    self.guac.sendKeyEvent(0, keysym);
                    if (keysym === KEYSYM_ALT) {
                        self.guac.sendKeyEvent(1, keysym);
                        self.guac.sendKeyEvent(0, keysym);
                    }
                });
                this.keysPressed = [];
            }

            this.connect = function(envId, vmId) {
                var self = this;

                try {
                    this.guac.disconnect();
                } catch (e) { /* ignore */
                }

                window.setTimeout(function() {
                        var connectionString = 'eid=' + envId + '&vid=' + vmId;
                        if (self.enhancedMode) {
                            var outerDisplay = document.getElementById('outer-display');
                            var supportedAudioFormats = Guacamole.AudioPlayer.getSupportedTypes();
                            connectionString += '&enhanced=1&width=' + outerDisplay.offsetWidth + '&height=' + outerDisplay.offsetHeight + '&audio=' + supportedAudioFormats.join('&audio=');
                        }
                        self.guac.connect(connectionString);
                    },
                    500);
            };
            
            this.toggleEnhancedMode = function(enabled) {
                this.enhancedMode = enabled;
                $('#enhanced-mode-switch').prop('checked', enabled);
                $('#vm-dropdown-menu a.active').first().triggerHandler('click');
            };

            this.initialize();

            this.sendCad = function() {
                this.unregisterAllKeypresses();
                this.guac.sendKeyEvent(1, KEYSYM_CTRL);
                this.guac.sendKeyEvent(1, KEYSYM_ALT);
                this.guac.sendKeyEvent(1, KEYSYM_DELETE);
                this.guac.sendKeyEvent(0, KEYSYM_CTRL);
                this.guac.sendKeyEvent(0, KEYSYM_ALT);
                this.guac.sendKeyEvent(0, KEYSYM_DELETE);
            };

            this.sendKeys = function(text) {
                var self = this;
                this.unregisterAllKeypresses();
                text = text.replace(/\r\n?/g, "\n");
                var strArr = text.split("");
                
                var sendKey = function(strArr) {
                    if (strArr.length === 0) return;
                    
                    var char = strArr.shift();
                    
                    var codepoint = char.charCodeAt(0);
                    var keysym = codepoint;
                    if (codepoint >= 0x0100) {
                        keysym = 0x01000000 | codepoint;
                    }
                    self.guac.sendKeyEvent(1, keysym);
                    self.guac.sendKeyEvent(0, keysym);
                    
                    window.setTimeout(sendKey, 10, strArr);
                }
                
                sendKey(strArr);
            };
        };

        var client = new Client.Rde(document.getElementById('display'));
        
        var vmCredentialsTarget = document.getElementById('vm-credentials-target');
        var vmCredentialsTemplate = Handlebars.compile(document.getElementById('vm-credentials-template').innerHTML);
        function showCredentialsForVm(vmCredentials) {
            vmCredentialsTarget.innerHTML = vmCredentialsTemplate(vmCredentials);
        }

        function showVmContextMenus(vmId) {
            var vmContextMenuDropdowns = $('.vm-context-menu-dropdown');
            vmContextMenuDropdowns.each(function(vmCintextMenuDropdownIndex, vmCOntextMenuDropdownElement) {
                var vmContextMenuDropdown = $(vmCOntextMenuDropdownElement);
                vmContextMenuDropdown.toggle(false);

                var vmContextMenus = vmContextMenuDropdown.find('.vm-context-menu');
                vmContextMenus.toggle(false);

                vmContextMenus.each(function(vmContextMenuIndex, vmContextMenuElement) {
                    var vmContextMenu = $(vmContextMenuElement);
                    if (vmContextMenu.data('vmId') === vmId) {
                        vmContextMenu.toggle(true);
                        vmContextMenuDropdown.toggle(true);
                    }
                });
            });
        }

        var vmItems = $('#vm-dropdown-menu a');
        vmItems.on(
            'click',
            function() {
                if (checkVmStateTimeout) {
                    clearTimeout(checkVmStateTimeout);
                }
                $('#vm-dropdown-menu a').removeClass('active');
                var $this = $(this);
                $this.addClass('active');
                client.connect(envId, $this.data('vmId'));
                $('#vm-dropdown-btn').text($this.text());
                $('.connection-error-box').hide();
                $('#display').show();
                showCredentialsForVm($this.data('vmCredentials'));
                showVmContextMenus($this.data('vmId'));
            }).first().triggerHandler('click');

        var selectVm = function(vmName) {
            vmItems.each(function(i, el) {
                if (el.dataset.vmName === vmName) {
                    $(el).triggerHandler('click');
                }
            });
        };

        document.addEventListener('select-vm', function(e) {
            selectVm(e.detail);
        });

        $('#cad-btn').on('click',
            function() {
                client.sendCad();
                $(this).blur();
            });
        
        var pasteTextHandler = function() {
            var stringToSend = $(this).data('text');
            if ($(this).hasClass('paste-enter')) {
                stringToSend += "\n";
            }
            if ($(this).hasClass('paste-tab')) {
                stringToSend += "\t";;
            }
            client.sendKeys(stringToSend);
        };

        $('.paste-text').on('click', pasteTextHandler);
        $('#vm-credentials-target').on('click', '.paste-credential', pasteTextHandler);

        $('.reconnect-display-btn').on('click',
            function() {
                $('#vm-dropdown-menu a.active').triggerHandler('click');
                $(this).blur();
            });

        var infoModal = $('#launch-info-modal');
        var errataModel = $('#launch-errata-modal');
        if (infoModal.data('show') === true) {
            infoModal.modal('show');
            if (errataModel.data('show') === true) {
                $('#info-modal-ok-btn').on('click',
                    function() {
                        window.setTimeout(function() { errataModel.modal('show'); }, 500);
                    });
            }
        } else if (errataModel.data('show') === true) {
            errataModel.modal('show');
        }

        $('.power-op').on('click',
            function() {
                var op = $(this).data('op');
                var vmId = $('#vm-dropdown-menu a.active').first().data('vmId');
                $.ajax({
                    url: '/Labs/NVmControl/f2def404-29f7-e911-abe3-00155de2c913/' + vmId + '/' + op,
                    type: 'get',
                    success: function() {
                        if (op === 'start') {
                            checkVmState(false);
                        }
                    },
                    error: function() {
                        alert('An error occurred whilst carrying out that power operation');
                    }
                });
                $(this).blur();
            });
        
        $('#enhanced-mode-switch').on('click', function() {
            client.toggleEnhancedMode($(this).is(':checked'));
            $(this).blur();
        });

        var timerTarget = $("#lab-timer");
        var timerTargetTimer = $("#lab-timer-timer");
        var timerWarning = $('#lab-timer-warning');
        var warningThreshold = 14;
        var canExtend = true;

        $('#stopwatch').popover();
        timerWarning.popover({
            template:
                '<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header bg-warning"></h3><div class="popover-body"></div></div>',
            trigger: 'manual',
            placement: 'top',
            content:
                '<div class="text-center"><div class="mb-2">You may extend by a further 60 minutes:</div>' +
                    '<button id="extend-timer-btn" class="btn btn-success">Extend</button>' +
                    '<button id="ignore-timer-btn" class="btn btn-secondary ml-2">Ignore</button>' +
                    '</div>',
            html: true,
            title: '<i class="fa fa-exclamation-triangle"></i> Your Lab will end soon',
            boundary: 'window'
        });

        $('body').on('click',
            '#extend-timer-btn',
            function() {
                $('#extend-timer-btn').attr('disabled', true).html('Requesting...');
                $.ajax({
                    url: '/Modules/AddTime/f2def404-29f7-e911-abe3-00155de2c913',
                    type: 'post',
                    success: function(data) {
                        startTimer(data);
                        timerTarget.removeClass('badge-warning').addClass('badge-secondary');
                        timerWarning.popover('hide');
                    },
                    error: function() {
                        alert('There was an error extending your lab expiry time. Please try again or contact support');
                    }
                });
            });
        $('body').on('click',
            '#ignore-timer-btn',
            function() {
                timerWarning.popover('toggle');
            });

        $('.popover-help').popover({
            container: "body",
            placement: "top",
            trigger: "hover",
            boundary: "window"
        });

        var timer = new Timer();

        function startTimer(seconds) {
            if (timer.isRunning()) {
                timer.stop();
            }

            timer.start({
                precision: 'seconds',
                startValues: { seconds: seconds },
                target: { seconds: 0 },
                countdown: true
            });
        }

        function showTimerWarning() {
            timerWarning.popover('show');
            timerTarget.removeClass('badge-secondary')
                .addClass('badge-warning')
                .on('click',
                    function() {
                        timerWarning.popover('toggle');
                    });
        }

        timerTargetTimer.html(timer.getTimeValues().toString());

        timer.addEventListener('secondsUpdated',
            function(e) {
                var timeValues = timer.getTimeValues();
                timerTargetTimer.html(timeValues.toString());
            });

        timer.addEventListener('minutesUpdated',
            function(e) {
                var timeValues = timer.getTimeValues();
                if (canExtend && timeValues.days === 0 && timeValues.hours === 0 && timeValues.minutes === warningThreshold) {
                    showTimerWarning();
                }
            });

        timer.addEventListener('started',
            function(e) {
                var timeValues = timer.getTimeValues();
                if (canExtend && timeValues.days === 0 && timeValues.hours === 0 && timeValues.minutes <= warningThreshold) {
                    showTimerWarning();
                }
            });

        timer.addEventListener('targetAchieved',
            function() {
                window.onbeforeunload = null;
                window.location.replace('/Modules/ExpireLab/f2def404-29f7-e911-abe3-00155de2c913');
            });

        startTimer(28799);

        $('#screenshotBtn').on(
            'click',
            function() {
                var canvas = $('#display canvas').first();
                this.href = canvas[0].toDataURL();
                this.filename = 'screenshot.png';
                this.download = 'screenshot.png';
            });

        $('.dvd-image-item').on('click',
            function() {
                var self = $(this);
                $.ajax({
                    url: '/Labs/InsertIsoImage/f2def404-29f7-e911-abe3-00155de2c913',
                    type: 'POST',
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({
                        VmId: self.data('vmId'),
                        DiskDriveId: self.data('diskDriveId'),
                        MediaImageId: self.data('mediaImageId')
                    }),
                    dataType: 'json',
                    error: function() {
                        alert('An error occurred whilst inserting a DVD');
                    }
                });
            });
        $('.dvd-drive-eject-btn').on('click',
            function() {
                var self = $(this);
                $.ajax({
                    url: '/Labs/EjectIsoImage/f2def404-29f7-e911-abe3-00155de2c913',
                    type: 'POST',
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({
                        VmId: self.data('vmId'),
                        DiskDriveId: self.data('diskDriveId')
                    }),
                    dataType: 'json',
                    error: function() {
                        alert('An error occurred whilst ejecting a DVD');
                    }
                });
            });
        $('.net-switch-item').on('click',
            function() {
                var self = $(this);
                $.ajax({
                    url: '/Labs/ConnectNetAdapterSwitch/f2def404-29f7-e911-abe3-00155de2c913',
                    type: 'POST',
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({
                        VmId: self.data('vmId'),
                        VNetAdapterId: self.data('netAdapterId'),
                        VSwitchId: self.data('switchId')
                    }),
                    dataType: 'json',
                    error: function() {
                        alert('An error occurred whilst changing network connections');
                    }
                });
            });

        $('.fd-image-item').on('click',
            function() {
                var self = $(this);
                $.ajax({
                    url: '/Labs/InsertFdImage/f2def404-29f7-e911-abe3-00155de2c913',
                    type: 'POST',
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({
                        VmId: self.data('vmId'),
                        MediaImageId: self.data('mediaImageId')
                    }),
                    dataType: 'json',
                    error: function() {
                        alert('An error occurred whilst inserting a floppy disk image');
                    }
                });
            });
        $('.fd-drive-eject-btn').on('click',
            function() {
                var self = $(this);
                $.ajax({
                    url: '/Labs/EjectFdImage/f2def404-29f7-e911-abe3-00155de2c913',
                    type: 'POST',
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({
                        VmId: self.data('vmId')
                    }),
                    dataType: 'json',
                    error: function() {
                        alert('An error occurred whilst ejecting a floppy disk image');
                    }
                });
            });

        var labDns = false;

        function clearDnsRecords() {
            $('.dns-records').each(function() {
                var el = $(this);
                el.html('');
            });
        }
        function showDnsRecords() {
            $('.dns-records').each(function() {
                var el = $(this);
                if (el.find('tr').length > 0) {
                    el.show();
                } else {
                    el.siblings('.no-dns-records').show();
                }
            });
        }
        function showDnsLoading() {
            $('.dns-records,.no-dns-records').hide();
            $('.dns-records-loading').show();
        }
        function hideDnsLoading() {
            $('.dns-records-loading').hide();
        }
        function appendDnsEntries(data) {
            appendARecords(data.ARecords);
            appendAaaaRecords(data.AaaaRecords);
            appendCnameRecords(data.CnameRecords);
            appendMxRecords(data.MxRecords);
            appendSrvRecords(data.SrvRecords);
            appendTxtRecords(data.TxtRecords);
        }
        function setLabZoneName(zoneName) {
            $('span.dns-zone-name').html(zoneName);
        }
        var aRecordsBody = $('#lab_ui_a-records');
        var aaaaRecordsBody = $('#lab_ui_aaaa-records');
        var cnameRecordsBody = $('#lab_ui_cname-records');
        var mxRecordsBody = $('#lab_ui_mx-records');
        var srvRecordsBody = $('#lab_ui_srv-records');
        var txtRecordsBody = $('#lab_ui_txt-records');
        function getEditDeleteCell() {
            return $('<td/>')
                .append($('<a href="#" class="dns-record-edit-btn dns-record-op-btn text-black mr-2" data-op="edit"/>').append($('<i class="fas fa-edit"></i>')))
                .append($('<a href="#" class="dns-record-delete-btn dns-record-op-btn text-danger" data-op="delete"/>').append($('<i class="fas fa-trash-alt"></i>')));
        }
        function appendARecords(aRecords) {
            aRecords.forEach(function(record) {
                var row = $('<tr/>');
                row.data('recordType', 'a');
                row.data('recordSetId', record.RecordSetId);
                row.data('recordId', record.RecordId);
                row.data('name', record.Name);
                row.data('ipv4Address', record.Ipv4Address);
                row.append($('<td/>').html(record.Name));
                row.append($('<td/>').html(record.Ipv4Address));
                row.append(getEditDeleteCell());
                aRecordsBody.append(row);
            });
        }
        function appendAaaaRecords(aaaaRecords) {
            aaaaRecords.forEach(function(record) {
                var row = $('<tr/>');
                row.data('recordType', 'aaaa');
                row.data('recordSetId', record.RecordSetId);
                row.data('recordId', record.RecordId);
                row.data('name', record.Name);
                row.data('ipv6Address', record.Ipv6Address);
                row.append($('<td/>').html(record.Name));
                row.append($('<td/>').html(record.Ipv6Address));
                row.append(getEditDeleteCell());
                aaaaRecordsBody.append(row);
            });
        }
        function appendCnameRecords(cnameRecords) {
            cnameRecords.forEach(function(record) {
                var row = $('<tr/>');
                row.data('recordType', 'cname');
                row.data('recordSetId', record.RecordSetId);
                row.data('recordId', record.RecordId);
                row.data('name', record.Name);
                row.data('cname', record.Cname);
                row.append($('<td/>').html(record.Name));
                row.append($('<td/>').html(record.Cname));
                row.append(getEditDeleteCell());
                cnameRecordsBody.append(row);
            });
        }
        function appendMxRecords(mxRecords) {
            mxRecords.forEach(function(record) {
                var row = $('<tr/>');
                row.data('recordType', 'mx');
                row.data('recordSetId', record.RecordSetId);
                row.data('recordId', record.RecordId);
                row.data('name', record.Name);
                row.data('preference', record.Preference);
                row.data('exchange', record.Exchange);
                row.append($('<td/>').html(record.Name));
                row.append($('<td/>').html(record.Preference));
                row.append($('<td/>').html(record.Exchange));
                row.append(getEditDeleteCell());
                mxRecordsBody.append(row);
            });
        }
        function appendSrvRecords(srvRecords) {
            srvRecords.forEach(function(record) {
                var row = $('<tr/>');
                row.data('recordType', 'srv');
                row.data('recordSetId', record.RecordSetId);
                row.data('recordId', record.RecordId);
                row.data('name', record.Name);
                row.data('priority', record.Priority);
                row.data('weight', record.Weight);
                row.data('port', record.Port);
                row.data('target', record.Target);
                row.append($('<td/>').html(record.Name));
                row.append($('<td/>').html(record.Priority));
                row.append($('<td/>').html(record.Weight));
                row.append($('<td/>').html(record.Port));
                row.append($('<td/>').html(record.Target));
                row.append(getEditDeleteCell());
                srvRecordsBody.append(row);
            });
        }
        function appendTxtRecords(txtRecords) {
            txtRecords.forEach(function(record) {
                var row = $('<tr/>');
                row.data('recordType', 'txt');
                row.data('recordSetId', record.RecordSetId);
                row.data('recordId', record.RecordId);
                row.data('name', record.Name);
                row.data('value', record.Value);
                row.append($('<td/>').html(record.Name));
                row.append($('<td/>').html(record.Value));
                row.append(getEditDeleteCell());
                txtRecordsBody.append(row);
            });
        }
        function loadLabDns(id) {
            showDnsLoading();
            clearDnsRecords();
            $.ajax({
                url: '/LabDomains/GetLabDnsEntries/' + id,
                type: 'GET',
                dataType: 'json',
                success: function(data) {
                    setLabZoneName(data.FqZoneName);
                    appendDnsEntries(data);
                },
                complete: function() {
                    hideDnsLoading();
                    showDnsRecords();
                }
            });
        }

        var dnsForms = {
            "a": $('#lab_ui_a-record-form'),
            "aaaa": $('#lab_ui_aaaa-record-form'),
            "cname": $('#lab_ui_cname-record-form'),
            "mx": $('#lab_ui_mx-record-form'),
            "srv": $('#lab_ui_srv-record-form'),
            "txt": $('#lab_ui_txt-record-form')
        };
        var dnsFormsModal = $('#lab_ui_lab-dns-modal');
        var dnsFormsModalButtons = dnsFormsModal.find('.modal-footer button');
        function hideForms() {
            $('.dns-record-form').hide().removeClass('active');
        }
        function showRecordForm(type) {
            dnsForms[type].show().addClass('active');
        }
        function resetRecordFormFields(type) {
            dnsForms[type].find('input,textarea').val('').removeAttr('readonly');
            dnsForms[type].find('input[name="Delete"]').val('false');
        }
        function fillRecordForm(type, data) {
            var fields = dnsForms[type].find('input,textarea');
            fields.each(function() {
                var fieldName = this.name.charAt(0).toLowerCase() + this.name.slice(1);
                if (fieldName in data) {
                    this.value = data[fieldName];
                }
            });
        }
        function disableNameField(type) {
            dnsForms[type].find('input[name="Name"]').attr('readonly', true);
        }
        function hideDnsDeleteButton() {
            $('#delete-dns-record-btn').hide();
        }
        function showDnsDeleteButton() {
            $('#delete-dns-record-btn').show();
        }
        function disableDnsFormButtons() {
            dnsFormsModalButtons.attr('disabled', true);
        }
        function enableDnsFormButtons() {
            dnsFormsModalButtons.removeAttr('disabled');
        }
        function disableDnsOpButtons() {
            $('a.dns-record-op-btn').addClass('disabled');
        }
        function enableDnsOpButtons() {
            $('a.dns-record-op-btn').removeClass('disabled');
        }
        function setDeleteFlag() {
            dnsFormsModal.find('form.active:first input[name="Delete"]').val('true');
        }
        function registerDnsClickEvents() {
            dnsFormsModal.on('hidden.bs.modal', function() {
                client.captureKeyboard();
                enableDnsOpButtons();
            });
            dnsFormsModal.on('shown.bs.modal', function() {
                client.releaseKeyboard();
            });
            $('a.add-dns-record-btn').on('click', function(e) {
                hideForms();
                var type = $(this).data('recordType');
                if (type in dnsForms) {
                    showRecordForm(type);
                    resetRecordFormFields(type);
                    hideDnsDeleteButton();
                    enableDnsFormButtons();
                    dnsFormsModal.modal('show');
                }

                e.preventDefault();
            });
            $('tbody.dns-records').on('click', 'a.dns-record-op-btn', function(e) {
                e.preventDefault();

                if ($(this).hasClass('disabled')) return;

                hideForms();
                var record = $(this).closest('tr').data();
                var op = $(this).data('op');
                if (!record.recordType in dnsForms) {
                    return;
                }

                disableDnsOpButtons();
                
                if (op === 'edit') {
                    showRecordForm(record.recordType);
                    resetRecordFormFields(record.recordType);
                    disableNameField(record.recordType);
                    showDnsDeleteButton();
                    fillRecordForm(record.recordType, record);
                    enableDnsFormButtons();
                    dnsFormsModal.modal('show');
                    return;
                }
                
                if (op === 'delete') {
                    showRecordForm(record.recordType);
                    resetRecordFormFields(record.recordType);
                    fillRecordForm(record.recordType, record);
                    setDeleteFlag();
                    dnsFormsModal.find('form.active').trigger('submit');
                    return;
                }

                enableDnsOpButtons();
            });
            $('.dns-record-form').on('submit', function(e) {
                e.preventDefault();
                var form = $(this);
                var formData = new FormData(form[0]);

                $.ajax({
                    url: form.attr('action'),
                    type: 'post',
                    processData: false,
                    contentType: false,
                    data: formData,
                    success: function() {
                        loadLabDns('f2def404-29f7-e911-abe3-00155de2c913');
                        dnsFormsModal.modal('hide');
                    },
                    complete: function() {
                        enableDnsFormButtons();
                        enableDnsOpButtons();
                    }
                });
            });
            $('#save-dns-record-btn').on('click', function(e) {
                e.preventDefault();
                disableDnsFormButtons();
                dnsFormsModal.find('form.active').trigger('submit');
            });
            $('#delete-dns-record-btn').on('click', function(e) {
                e.preventDefault();
                setDeleteFlag();
                $('#save-dns-record-btn').triggerHandler('click');
            });
        }

        if (labDns) {
            document.addEventListener('DOMContentLoaded', function() {
                loadLabDns('f2def404-29f7-e911-abe3-00155de2c913');
                registerDnsClickEvents();
            });
        }

        var fullscreenBtn = document.getElementById('fullscreen-btn');
        var exitFullscreenBtn = document.getElementById('exit-fullscreen-btn');

        fullscreenBtn.addEventListener('click',
            function() {
                var elem = document.documentElement;
                if (elem.requestFullscreen) {
                    elem.requestFullscreen();
                } else if (elem.mozRequestFullScreen) { /* Firefox */
                    elem.mozRequestFullScreen();
                } else if (elem.webkitRequestFullscreen) { /* Chrome, Safari and Opera */
                    elem.webkitRequestFullscreen();
                } else if (elem.msRequestFullscreen) { /* IE/Edge */
                    elem.msRequestFullscreen();
                }
            });
        
        exitFullscreenBtn.addEventListener('click',
            function() {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) { /* Firefox */
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) { /* IE/Edge */
                    document.msExitFullscreen();
                }
            });
        
        document.addEventListener('fullscreenchange', function() {
            if (document.fullscreenElement === null) {
                exitFullscreenBtn.style.display = 'none';
                fullscreenBtn.style.display = '';
            } else {
                exitFullscreenBtn.style.display = '';
                fullscreenBtn.style.display = 'none';
            }
        });
        
        document.body.style.backgroundColor = '#fff';
    </script>



</body></html>